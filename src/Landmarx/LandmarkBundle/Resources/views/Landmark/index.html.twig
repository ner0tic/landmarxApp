{% extends '::base.html.twig' %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script type="text/javascript" src="{{ asset('/bundles/landmarxlandmark/js/gmaps.js') }}"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            map = new GMaps({
                div: '#map',
                lat: {{ current['latitude'] }},
                lng: {{ current['longitude'] }},
                MapTypeId: google.maps.MapTypeId.TERRAIN,
                disableDefaultUI: true,
            });
        });
    </script>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('/bundles/landmarxutility/css/index.css') }}" />
    <link rel="stylesheet" href="{{ asset('/bundles/landmarxlandmark/css/landmark.css') }}" />
    <link rel="stylesheet" href="{{ asset('/bundles/landmarxlandmark/css/map.css') }}" />
{% endblock %}

{% block content %}
    {% block gmap %}
    <div id="map"></div>
    {% endblock %}
    
    {% block info_overlay %}
    <div id="info-overlay-wrapper">
        <div class="info-overlay-bg"></div>
        <div id="info-overlay">
            <h2>{{ "landmarks nearby" | title }}</h2>
            {{ block ('results') }}
        </div>
    </div>
    {% endblock %}
{% endblock %}

{% block results %}
    <ul>
        {% for landmark in landmarks %}
        <li>
            <div class="item {{ (landmark is even ? 'even' : 'odd') }}-item">
                {{ block('item_content') }}
                {{ block('toolbox') }}
                
            </div>   
        </li>
        {% else %}
        <li><em>{{ 'no landmarks found.' | title }}</em></li>
        {% endfor %}   
        {{ block('pager') }}
    </ul>
{% endblock %}

{% block item_icon %}
<div class="item-icon">
    <i class="icon {{ landmark.type.slug }}-icon"></i>
</div> 
{% endblock %}

{% block item_label %}
<div class="item-label">
    <p class="item-title">{{ landmark.name | title }}</p>
    <hr />
    <p class="item-subtitle">{{ landmark.type | title }}</p>
</div>
{% endblock %}

{% block item_content %}
<div class="item-content">
    {{ block('item_icon') }}
    {{ block('item_label') }}                    
</div>
{% endblock %}

{% block toolbox %}
<div class="toolbox">
    <ul>
        <li>{{ path('landmarx_landmark_show', { 'slug': landmark.slug }) }}">
                <i class="preview-icon icon"></i>
            </a>
        </li>
        {% if is_granted(['ROLE_ADMIN', 'ROLE_OWNER']) %}
        <li>
            <a href="{{ path('landmarx_landmark_edit', { 'slug': landmark.slug }) }}">
                <i class="edit-icon icon"></i>
            </a>
        </li>
        <li>
            <a href="{{ path('landmarx_landmark_remove', { 'slug': landmark.slug }) }}">
                <i class="remove-icon icon">
            </a>
        </li>
        {% endif %}
    </ul>
</div>
{% endblock %}

{% block pager %}
<li class="pager">
    <div class="container">
        <div class="pull-left">
            {{ 'Showing '~pager.currentPageResults|length~' of '~pager.nbResults~' items.' | lower }}
        </div>
        <div class="pull-right">
            {% if pager.haveToPaginate %}
            {{ pagerfanta(pager) }}
            {% endif %}
        </div>
    </div>
</li>
{% endblock %}